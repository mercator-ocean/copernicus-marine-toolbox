Release 2.3.0
=============

This release introduces new features and improvements.

General
-------

New Features
^^^^^^^^^^^^

* Increased resilience when parsing or fetching metadata. The ``describe`` command is now more robust, and consequently so are the ``subset`` and ``get`` commands.
* Improved the documentation page *Polygons Extractor Using the Copernicus Marine Toolbox* in the *Usage and Technical Details* section. It is now clearer and requires fewer dependencies. See :ref:`Polygons Extractor <polygons-based-data-selection>`.
* Added a :ref:`Versioning and End-of-Life Policy <versioning-and-end-of-life-policy>` page to the documentation for better clarity on the support timeline of the Toolbox.
* Added new dependency, ``psutil``. See :ref:`installation page <installation-page-dependencies>` for the list of dependencies.

Fixes
^^^^^

* Updated the :ref:`Installation page <installation-page-domains>` in the documentation with a more up-to-date link to test the connection to the server domains.

Subset
------

New Features
^^^^^^^^^^^^

* Inverting the order of the arguments for minimum and maximum values in ``subset`` will now raise an error. Except for the longitude, it raises a warning (see item below). This helps users avoid mistakes and ensures more consistent behavior.
* Requests across the antemeridian line (180Â° longitude) can now be made by specifying a minimum value greater than the maximum value (except for sparse datasets). The Toolbox will automatically shift the window to the left or right of the antemeridian line, depending on the requested area. See the :ref:`Subset documentation <about-longitude-range>` for details.
* Subset results now preserve more attributes, as the Toolbox passes through attributes from the server data. Previously, only a whitelisted set of attributes was included.
* Added a new option ``--split-on`` to the `subset` command to split the output files based on time or variables when subsetting in netcdf format. See :ref:`subset usage page <subset-split-on>` for more details.

Fixes
^^^^^

* Fixed an issue where the ``valid_range`` attribute in some NetCDF files was not in the correct format and therefore not CF-compliant. The Toolbox now ensures the ``valid_range`` attribute matches the data type.
* Fixed an issue where no error was raised when an unsupported file format was requested for sparse datasets. The Toolbox now raises a ``WrongFormatRequested`` exception in this case.
* Changed the result of the ``--create-template`` option to have a consistent type with the Command Line Interface.
* Fixed an issue where some attributes were missing when variables were explicitly specified in a subset request. Results should now be consistent.
* Fixed a bug where using ``zarr>=3`` would be slower due to blocking operations in a loop. The Toolbox now uses non-blocking operations to improve performance.
* Fixed an issue where the Toolbox wouldn't work with Dask distributed. The Toolbox is now compatible with Dask distributed setups.

Describe
--------

New Features
^^^^^^^^^^^^

* Added a flag (:ref:`see here <raise_on_error>`) to the ``describe`` command to raise an error when fetching or parsing fails. Default is ``False``.

Get
---

New Features
^^^^^^^^^^^^

* Removed the incompatibility between the ``sync`` option and the ``no_directories`` option. They can now be used together.
